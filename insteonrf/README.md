An initial attempt at breaking apart the scripts into a maintainable library.

TODO: Pretty much everything
